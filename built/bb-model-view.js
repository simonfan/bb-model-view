/*!
 *
 * Copyright 2009-2012 Kris Kowal under the terms of the MIT
 * license found at http://github.com/kriskowal/q/raw/master/LICENSE
 *
 * With parts by Tyler Close
 * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found
 * at http://www.opensource.org/licenses/mit-license.html
 * Forked at ref_send.js version: 2009-05-11
 *
 * With parts by Mark Miller
 * Copyright (C) 2011 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */

//     pipe
//     (c) simonfan
//     pipe is licensed under the MIT terms.

//     jquery-meta-data
//     (c) simonfan
//     jquery-meta-data is licensed under the MIT terms.

//     JqueryPipe
//     (c) simonfan
//     JqueryPipe is licensed under the MIT terms.

//     pump
//     (c) simonfan
//     pump is licensed under the MIT terms.

//     jquery-pump
//     (c) simonfan
//     jquery-pump is licensed under the MIT terms.

//     bb-model-view
//     (c) simonfan
//     bb-model-view is licensed under the MIT terms.

!function(t){if("function"==typeof bootstrap)bootstrap("promise",t);else if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define("q",t);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=t}else Q=t()}(function(){function t(t){return function(){return Q.apply(t,arguments)}}function e(t){return t===Object(t)}function n(t){return"[object StopIteration]"===ee(t)||t instanceof V}function r(t,e){if(I&&e.stack&&"object"==typeof t&&null!==t&&t.stack&&-1===t.stack.indexOf(ne)){for(var n=[],r=e;r;r=r.source)r.stack&&n.unshift(r.stack);n.unshift(t.stack);var o=n.join("\n"+ne+"\n");t.stack=i(o)}}function i(t){for(var e=t.split("\n"),n=[],r=0;r<e.length;++r){var i=e[r];u(i)||o(i)||!i||n.push(i)}return n.join("\n")}function o(t){return-1!==t.indexOf("(module.js:")||-1!==t.indexOf("(node.js:")}function s(t){var e=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(e)return[e[1],Number(e[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(t);return r?[r[1],Number(r[2])]:void 0}function u(t){var e=s(t);if(!e)return!1;var n=e[0],r=e[1];return n===K&&r>=M&&se>=r}function a(){if(I)try{throw new Error}catch(t){var e=t.stack.split("\n"),n=e[0].indexOf("@")>0?e[1]:e[2],r=s(n);if(!r)return;return K=r[0],r[1]}}function p(t,e,n){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(e+" is deprecated, use "+n+" instead.",new Error("").stack),t.apply(t,arguments)}}function c(t){return v(t)?t:g(t)?S(t):P(t)}function f(){function t(t){e=t,o.source=t,H(n,function(e,n){B(function(){t.promiseDispatch.apply(t,n)})},void 0),n=void 0,r=void 0}var e,n=[],r=[],i=X(f.prototype),o=X(h.prototype);if(o.promiseDispatch=function(t,i,o){var s=Z(arguments);n?(n.push(s),"when"===i&&o[1]&&r.push(o[1])):B(function(){e.promiseDispatch.apply(e,s)})},o.valueOf=function(){if(n)return o;var t=y(e);return v(t)&&(e=t),t},o.inspect=function(){return e?e.inspect():{state:"pending"}},c.longStackSupport&&I)try{throw new Error}catch(s){o.stack=s.stack.substring(s.stack.indexOf("\n")+1)}return i.promise=o,i.resolve=function(n){e||t(c(n))},i.fulfill=function(n){e||t(P(n))},i.reject=function(n){e||t(k(n))},i.notify=function(t){e||H(r,function(e,n){B(function(){n(t)})},void 0)},i}function l(t){if("function"!=typeof t)throw new TypeError("resolver must be a function.");var e=f();try{t(e.resolve,e.reject,e.notify)}catch(n){e.reject(n)}return e.promise}function d(t){return l(function(e,n){for(var r=0,i=t.length;i>r;r++)c(t[r]).then(e,n)})}function h(t,e,n){void 0===e&&(e=function(t){return k(new Error("Promise does not support operation: "+t))}),void 0===n&&(n=function(){return{state:"unknown"}});var r=X(h.prototype);if(r.promiseDispatch=function(n,i,o){var s;try{s=t[i]?t[i].apply(r,o):e.call(r,i,o)}catch(u){s=k(u)}n&&n(s)},r.inspect=n,n){var i=n();"rejected"===i.state&&(r.exception=i.reason),r.valueOf=function(){var t=n();return"pending"===t.state||"rejected"===t.state?r:t.value}}return r}function m(t,e,n,r){return c(t).then(e,n,r)}function y(t){if(v(t)){var e=t.inspect();if("fulfilled"===e.state)return e.value}return t}function v(t){return e(t)&&"function"==typeof t.promiseDispatch&&"function"==typeof t.inspect}function g(t){return e(t)&&"function"==typeof t.then}function j(t){return v(t)&&"pending"===t.inspect().state}function _(t){return!v(t)||"fulfilled"===t.inspect().state}function x(t){return v(t)&&"rejected"===t.inspect().state}function q(){re.length=0,ie.length=0,oe||(oe=!0)}function w(t,e){oe&&(ie.push(t),re.push(e&&"undefined"!=typeof e.stack?e.stack:"(no stack) "+e))}function b(t){if(oe){var e=J(ie,t);-1!==e&&(ie.splice(e,1),re.splice(e,1))}}function k(t){var e=h({when:function(e){return e&&b(this),e?e(t):this}},function(){return this},function(){return{state:"rejected",reason:t}});return w(e,t),e}function P(t){return h({when:function(){return t},get:function(e){return t[e]},set:function(e,n){t[e]=n},"delete":function(e){delete t[e]},post:function(e,n){return null===e||void 0===e?t.apply(void 0,n):t[e].apply(t,n)},apply:function(e,n){return t.apply(e,n)},keys:function(){return te(t)}},void 0,function(){return{state:"fulfilled",value:t}})}function S(t){var e=f();return B(function(){try{t.then(e.resolve,e.reject,e.notify)}catch(n){e.reject(n)}}),e.promise}function R(t){return h({isDef:function(){}},function(e,n){return N(t,e,n)},function(){return c(t).inspect()})}function O(t,e,n){return c(t).spread(e,n)}function D(t){return function(){function e(t,e){var s;if("undefined"==typeof StopIteration){try{s=r[t](e)}catch(u){return k(u)}return s.done?s.value:m(s.value,i,o)}try{s=r[t](e)}catch(u){return n(u)?u.value:k(u)}return m(s,i,o)}var r=t.apply(this,arguments),i=e.bind(e,"next"),o=e.bind(e,"throw");return i()}}function E(t){c.done(c.async(t)())}function C(t){throw new V(t)}function A(t){return function(){return O([this,T(arguments)],function(e,n){return t.apply(e,n)})}}function N(t,e,n){return c(t).dispatch(e,n)}function T(t){return m(t,function(t){var e=0,n=f();return H(t,function(r,i,o){var s;v(i)&&"fulfilled"===(s=i.inspect()).state?t[o]=s.value:(++e,m(i,function(r){t[o]=r,0===--e&&n.resolve(t)},n.reject,function(t){n.notify({index:o,value:t})}))},void 0),0===e&&n.resolve(t),n.promise})}function F(t){return m(t,function(t){return t=W(t,c),m(T(W(t,function(t){return m(t,L,L)})),function(){return t})})}function G(t){return c(t).allSettled()}function z(t,e){return c(t).then(void 0,void 0,e)}function $(t,e){return c(t).nodeify(e)}var I=!1;try{throw new Error}catch(U){I=!!U.stack}var K,V,M=a(),L=function(){},B=function(){function t(){for(;e.next;){e=e.next;var n=e.task;e.task=void 0;var i=e.domain;i&&(e.domain=void 0,i.enter());try{n()}catch(s){if(o)throw i&&i.exit(),setTimeout(t,0),i&&i.enter(),s;setTimeout(function(){throw s},0)}i&&i.exit()}r=!1}var e={task:void 0,next:null},n=e,r=!1,i=void 0,o=!1;if(B=function(t){n=n.next={task:t,domain:o&&process.domain,next:null},r||(r=!0,i())},"undefined"!=typeof process&&process.nextTick)o=!0,i=function(){process.nextTick(t)};else if("function"==typeof setImmediate)i="undefined"!=typeof window?setImmediate.bind(window,t):function(){setImmediate(t)};else if("undefined"!=typeof MessageChannel){var s=new MessageChannel;s.port1.onmessage=function(){i=u,s.port1.onmessage=t,t()};var u=function(){s.port2.postMessage(0)};i=function(){setTimeout(t,0),u()}}else i=function(){setTimeout(t,0)};return B}(),Q=Function.call,Z=t(Array.prototype.slice),H=t(Array.prototype.reduce||function(t,e){var n=0,r=this.length;if(1===arguments.length)for(;;){if(n in this){e=this[n++];break}if(++n>=r)throw new TypeError}for(;r>n;n++)n in this&&(e=t(e,this[n],n));return e}),J=t(Array.prototype.indexOf||function(t){for(var e=0;e<this.length;e++)if(this[e]===t)return e;return-1}),W=t(Array.prototype.map||function(t,e){var n=this,r=[];return H(n,function(i,o,s){r.push(t.call(e,o,s,n))},void 0),r}),X=Object.create||function(t){function e(){}return e.prototype=t,new e},Y=t(Object.prototype.hasOwnProperty),te=Object.keys||function(t){var e=[];for(var n in t)Y(t,n)&&e.push(n);return e},ee=t(Object.prototype.toString);V="undefined"!=typeof ReturnValue?ReturnValue:function(t){this.value=t};var ne="From previous event:";c.resolve=c,c.nextTick=B,c.longStackSupport=!1,c.defer=f,f.prototype.makeNodeResolver=function(){var t=this;return function(e,n){e?t.reject(e):t.resolve(arguments.length>2?Z(arguments,1):n)}},c.Promise=l,c.promise=l,l.race=d,l.all=T,l.reject=k,l.resolve=c,c.passByCopy=function(t){return t},h.prototype.passByCopy=function(){return this},c.join=function(t,e){return c(t).join(e)},h.prototype.join=function(t){return c([this,t]).spread(function(t,e){if(t===e)return t;throw new Error("Can't join: not the same: "+t+" "+e)})},c.race=d,h.prototype.race=function(){return this.then(c.race)},c.makePromise=h,h.prototype.toString=function(){return"[object Promise]"},h.prototype.then=function(t,e,n){function i(e){try{return"function"==typeof t?t(e):e}catch(n){return k(n)}}function o(t){if("function"==typeof e){r(t,u);try{return e(t)}catch(n){return k(n)}}return k(t)}function s(t){return"function"==typeof n?n(t):t}var u=this,a=f(),p=!1;return B(function(){u.promiseDispatch(function(t){p||(p=!0,a.resolve(i(t)))},"when",[function(t){p||(p=!0,a.resolve(o(t)))}])}),u.promiseDispatch(void 0,"when",[void 0,function(t){var e,n=!1;try{e=s(t)}catch(r){if(n=!0,!c.onerror)throw r;c.onerror(r)}n||a.notify(e)}]),a.promise},c.when=m,h.prototype.thenResolve=function(t){return this.then(function(){return t})},c.thenResolve=function(t,e){return c(t).thenResolve(e)},h.prototype.thenReject=function(t){return this.then(function(){throw t})},c.thenReject=function(t,e){return c(t).thenReject(e)},c.nearer=y,c.isPromise=v,c.isPromiseAlike=g,c.isPending=j,h.prototype.isPending=function(){return"pending"===this.inspect().state},c.isFulfilled=_,h.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},c.isRejected=x,h.prototype.isRejected=function(){return"rejected"===this.inspect().state};var re=[],ie=[],oe=!0;c.resetUnhandledRejections=q,c.getUnhandledReasons=function(){return re.slice()},c.stopUnhandledRejectionTracking=function(){q(),oe=!1},q(),c.reject=k,c.fulfill=P,c.master=R,c.spread=O,h.prototype.spread=function(t,e){return this.all().then(function(e){return t.apply(void 0,e)},e)},c.async=D,c.spawn=E,c["return"]=C,c.promised=A,c.dispatch=N,h.prototype.dispatch=function(t,e){var n=this,r=f();return B(function(){n.promiseDispatch(r.resolve,t,e)}),r.promise},c.get=function(t,e){return c(t).dispatch("get",[e])},h.prototype.get=function(t){return this.dispatch("get",[t])},c.set=function(t,e,n){return c(t).dispatch("set",[e,n])},h.prototype.set=function(t,e){return this.dispatch("set",[t,e])},c.del=c["delete"]=function(t,e){return c(t).dispatch("delete",[e])},h.prototype.del=h.prototype["delete"]=function(t){return this.dispatch("delete",[t])},c.mapply=c.post=function(t,e,n){return c(t).dispatch("post",[e,n])},h.prototype.mapply=h.prototype.post=function(t,e){return this.dispatch("post",[t,e])},c.send=c.mcall=c.invoke=function(t,e){return c(t).dispatch("post",[e,Z(arguments,2)])},h.prototype.send=h.prototype.mcall=h.prototype.invoke=function(t){return this.dispatch("post",[t,Z(arguments,1)])},c.fapply=function(t,e){return c(t).dispatch("apply",[void 0,e])},h.prototype.fapply=function(t){return this.dispatch("apply",[void 0,t])},c["try"]=c.fcall=function(t){return c(t).dispatch("apply",[void 0,Z(arguments,1)])},h.prototype.fcall=function(){return this.dispatch("apply",[void 0,Z(arguments)])},c.fbind=function(t){var e=c(t),n=Z(arguments,1);return function(){return e.dispatch("apply",[this,n.concat(Z(arguments))])}},h.prototype.fbind=function(){var t=this,e=Z(arguments);return function(){return t.dispatch("apply",[this,e.concat(Z(arguments))])}},c.keys=function(t){return c(t).dispatch("keys",[])},h.prototype.keys=function(){return this.dispatch("keys",[])},c.all=T,h.prototype.all=function(){return T(this)},c.allResolved=p(F,"allResolved","allSettled"),h.prototype.allResolved=function(){return F(this)},c.allSettled=G,h.prototype.allSettled=function(){return this.then(function(t){return T(W(t,function(t){function e(){return t.inspect()}return t=c(t),t.then(e,e)}))})},c.fail=c["catch"]=function(t,e){return c(t).then(void 0,e)},h.prototype.fail=h.prototype["catch"]=function(t){return this.then(void 0,t)},c.progress=z,h.prototype.progress=function(t){return this.then(void 0,void 0,t)},c.fin=c["finally"]=function(t,e){return c(t)["finally"](e)},h.prototype.fin=h.prototype["finally"]=function(t){return t=c(t),this.then(function(e){return t.fcall().then(function(){return e})},function(e){return t.fcall().then(function(){throw e})})},c.done=function(t,e,n,r){return c(t).done(e,n,r)},h.prototype.done=function(t,e,n){var i=function(t){B(function(){if(r(t,o),!c.onerror)throw t;c.onerror(t)})},o=t||e||n?this.then(t,e,n):this;"object"==typeof process&&process&&process.domain&&(i=process.domain.bind(i)),o.then(void 0,i)},c.timeout=function(t,e,n){return c(t).timeout(e,n)},h.prototype.timeout=function(t,e){var n=f(),r=setTimeout(function(){n.reject(new Error(e||"Timed out after "+t+" ms"))},t);return this.then(function(t){clearTimeout(r),n.resolve(t)},function(t){clearTimeout(r),n.reject(t)},n.notify),n.promise},c.delay=function(t,e){return void 0===e&&(e=t,t=void 0),c(t).delay(e)},h.prototype.delay=function(t){return this.then(function(e){var n=f();return setTimeout(function(){n.resolve(e)},t),n.promise})},c.nfapply=function(t,e){return c(t).nfapply(e)},h.prototype.nfapply=function(t){var e=f(),n=Z(t);return n.push(e.makeNodeResolver()),this.fapply(n).fail(e.reject),e.promise},c.nfcall=function(t){var e=Z(arguments,1);return c(t).nfapply(e)},h.prototype.nfcall=function(){var t=Z(arguments),e=f();return t.push(e.makeNodeResolver()),this.fapply(t).fail(e.reject),e.promise},c.nfbind=c.denodeify=function(t){var e=Z(arguments,1);return function(){var n=e.concat(Z(arguments)),r=f();return n.push(r.makeNodeResolver()),c(t).fapply(n).fail(r.reject),r.promise}},h.prototype.nfbind=h.prototype.denodeify=function(){var t=Z(arguments);return t.unshift(this),c.denodeify.apply(void 0,t)},c.nbind=function(t,e){var n=Z(arguments,2);return function(){function r(){return t.apply(e,arguments)}var i=n.concat(Z(arguments)),o=f();return i.push(o.makeNodeResolver()),c(r).fapply(i).fail(o.reject),o.promise}},h.prototype.nbind=function(){var t=Z(arguments,0);return t.unshift(this),c.nbind.apply(void 0,t)},c.nmapply=c.npost=function(t,e,n){return c(t).npost(e,n)},h.prototype.nmapply=h.prototype.npost=function(t,e){var n=Z(e||[]),r=f();return n.push(r.makeNodeResolver()),this.dispatch("post",[t,n]).fail(r.reject),r.promise},c.nsend=c.nmcall=c.ninvoke=function(t,e){var n=Z(arguments,2),r=f();return n.push(r.makeNodeResolver()),c(t).dispatch("post",[e,n]).fail(r.reject),r.promise},h.prototype.nsend=h.prototype.nmcall=h.prototype.ninvoke=function(t){var e=Z(arguments,1),n=f();return e.push(n.makeNodeResolver()),this.dispatch("post",[t,e]).fail(n.reject),n.promise},c.nodeify=$,h.prototype.nodeify=function(t){return t?void this.then(function(e){B(function(){t(null,e)})},function(e){B(function(){t(e)})}):this};var se=a();return c}),define("__pipe/streams/pump",["require","exports","module","lodash","q"],function(t,e,n){function r(t,e,n){var r=i.map(n,function(n){return this._destSet(e,n,t)},this);return o.all(r)}var i=t("lodash"),o=t("q");n.exports=function(t,e,n){var s=this.destination;return o(this._srcGet(this.source,t)).then(i.bind(function(i){return!this.isCached(t,i)||n?r.call(this,i,s,e):void 0},this)).fail(function(t){throw t})}}),define("__pipe/streams/drain",["require","exports","module","lodash","q"],function(t,e,n){var r=t("lodash"),i=t("q");n.exports=function(t,e,n){return i(this._destGet(this.destination,e[0])).then(r.bind(function(e){return!this.isCached(t,e)||n?this._srcSet(this.source,t,e):void 0},this)).fail(function(t){throw t})}}),define("__pipe/streams/index",["require","exports","module","lodash","q","./pump","./drain"],function(t,e){function n(t,e,n){var o=i.defer();e=e?r.pick(this._map,e):this._map;var s=r.map(e,function(e,r){return t.call(this,r,e,n)},this);return i.all(s).done(function(){o.resolve()}),o.promise}var r=t("lodash"),i=t("q");e.pump=r.partial(n,t("./pump")),e.drain=r.partial(n,t("./drain")),e.inject=function(t,e){if(!this.source)throw new Error("No source for pipe");var n=r.map(t,function(t,n){return!this.isCached(n,t)||e?this._srcSet(this.source,n,t):void 0},this);return i.all(n).then(r.bind(function(){this.pump(void 0,!0)},this),function(t){throw t})}}),define("__pipe/mapping",["require","exports","module","lodash"],function(t,e){var n=t("lodash");e.map=function(){var t,e;return n.isString(arguments[0])?(t=arguments[0],e=arguments[1]||t,e=n.isArray(e)?e:[e],this._map[t]=e):n.isObject(arguments[0])&&n.each(arguments[0],function(t,e){this.map(e,t)},this),this},e.removeLine=function(t){return delete this._map[t],this}}),define("pipe",["require","exports","module","subject","lodash","./__pipe/streams/index","./__pipe/mapping"],function(t,e,n){var r=t("subject"),i=t("lodash"),o=["srcGet","srcSet","destGet","destSet"],s=n.exports=r({initialize:function(t,e){e=e||{},i.each(o,function(t){this[t]=e[t]||this[t]},this),this._srcGet=this.srcGet||this.get,this._srcSet=this.srcSet||this.set,this._destGet=this.destGet||this.get,this._destSet=this.destSet||this.set,e.cache!==!1&&this.clearCache(),e.source&&this.from(e.source),e.destination&&this.to(e.destination),this._map={},this.map(t)},get:function(t,e){return t[e]},set:function(t,e,n){return t[e]=n,t},clearCache:function(){return this.cache={},this},isCached:function(t,e){return this.cache?this.cache[t]!==e?(this.cache[t]=e,!1):!0:!1},to:function(t){return this.clearCache(),this.destination=t,this},from:function(t){return this.clearCache(),this.source=t,this}});s.assignProto(t("./__pipe/streams/index")).assignProto(t("./__pipe/mapping"))}),define("__jquery-meta-data/helpers",["require","exports","module","jquery","lodash"],function(t,e){t("jquery"),t("lodash"),e.buildPrefixRegExp=function(t){return new RegExp("^"+t+"([A-Z$_].*$)")},e.lowercaseFirst=function(t){return t.charAt(0).toLowerCase()+t.slice(1)},e.uppercaseFirst=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},e.fullKey=function(t,n){return t?t+e.uppercaseFirst(n):n}}),define("__jquery-meta-data/read",["require","exports","module","lodash","./helpers"],function(t,e){function n(t){return t}var r=t("lodash"),i=t("./helpers");e.all=function(t,e){var o=t.data(),s=e.parse||n;if(e.prefix){var u=i.buildPrefixRegExp(e.prefix);return r.transform(o,function(n,r,o){var a=o.match(u);if(a){var p=i.lowercaseFirst(a[1]);r=s(r,p,o),e.replace&&t.data(o,r),n[p]=r}})}return r.mapValues(o,function(t,e){return s(t,e,e)})},e.single=function(t,e,n){var r=i.fullKey(e.prefix,n),o=t.data(r);return e.parse&&(o=e.parse(o,n,r),e.replace&&t.data(r,o)),o}}),define("__jquery-meta-data/set",["require","exports","module","lodash","./helpers"],function(t,e){var n=t("lodash"),r=t("./helpers");e.single=function(t,e,n,i){var o=r.fullKey(e.prefix,n);i=e.stringify?e.stringify(i,n,o):i,t.data(o,i)},e.multiple=function(t,r,i){n.each(i,function(n,i){e.single(t,r,i,n)})}}),define("jquery-meta-data",["require","exports","module","jquery","lodash","./__jquery-meta-data/read","./__jquery-meta-data/set"],function(t){var e=t("jquery"),n=t("lodash"),r=t("./__jquery-meta-data/read"),i=t("./__jquery-meta-data/set"),o={};e.metaData=function(){n.isObject(arguments[0])?n.assign(o,arguments[0]):o[arguments[0]]=arguments[1]},e.prototype.metaData=function(t){return t=n.isString(t)?o[t]:t,1===arguments.length?r.all(this,t):2!==arguments.length?(i.single(this,t,arguments[1],arguments[2]),this):n.isString(arguments[1])?r.single(this,t,arguments[1]):n.isObject(arguments[1])?(i.multiple(this,t,arguments[1]),this):void 0}}),define("jquery-pipe",["require","exports","module","lodash","jquery","pipe","jquery-meta-data"],function(t,e,n){function r(t){var e=t.split(u),n=e.shift();return{method:n,args:e}}var i=t("lodash"),o=t("jquery"),s=t("pipe"),u=(t("jquery-meta-data"),/\s*:\s*/g),a=n.exports=s.extend({initialize:function(t,e){e=e||{},e.destination=t,e.source=e.source||{},i.defaults(e,this.metaDataOptions);var n=t.metaData(e);s.prototype.initialize.call(this,n,e)},metaDataOptions:{prefix:"pipe",parse:function(t){return t.split(/\s*,\s*/g)}},destGet:function(t,e){var n=r(e);return t[n.method].apply(t,n.args)},destSet:function(t,e,n){var i=r(e),o=i.args;return o.push(n),t[i.method].apply(t,o)}});o.prototype.pipe=function(t){return a(this,t)}}),define("__pump/pipe",["require","exports","module","lodash"],function(t,e){var n=t("lodash");e.addPipe=function(){var t,e,r;n.isString(arguments[0])?(t=arguments[0],e=arguments[1],r=arguments[2]||{}):(t=n.uniqueId("pipe"),e=arguments[0],r=arguments[1]||{}),r.source=this.source;var i=this._buildPipe(e,r);return 0===n.size(this.pipes)&&this.setDrainingPipe(t),this.pipes[t]=i,i},e.pipe=e.addPipe,e.removePipe=function(t,e){return n.isFunction(t)?n.each(this.pipes,function(n,r){t.call(e,n,r)&&delete this.pipes[r]},this):n.isArray(t)?n.each(t,function(e,r){n.contains(t,r)&&delete this.pipes[r]},this):delete this.pipes[t],this},e.unpipe=e.removePipe}),define("__pump/streams/pump",["require","exports","module","lodash","q"],function(t,e){var n=t("lodash"),r=t("q");e.pump=function(t,e,i){var o;t?(t=n.isArray(t)?t:[t],o=n.pick(this.pipes,t)):o=this.pipes;var s=n.map(o,function(t){return t.pump(e,i)});return r.all(s)}}),define("__pump/streams/drain",["require","exports","module","lodash","q"],function(t,e){function n(t){return r.isString(this.drainingPipe)?this.pipes[this.drainingPipe]:r.isFunction(this.drainingPipe)?this.drainingPipe(t):r.isObject(this.drainingPipe)?this.drainingPipe:void 0}var r=t("lodash");t("q"),e.drainingPipe=void 0,e.drain=function(t,e,r){var i=this.pipes[t]||n.call(this,e);if(!i)throw new Error('Pipe "'+t+'" not found.');return i.drain(e,r)},e.setDrainingPipe=function(t){return this.drainingPipe=t,this}}),define("__pump/streams/inject",["require","exports","module","lodash","q"],function(t,e){var n=t("lodash"),r=t("q");e.inject=function(t,e){var i=this.srcSet||this.set;if(!this.source)throw new Error("No source for pump");var o=n.map(t,function(t,e){return i.call(this,this.source,e,t)},this);return r.all(o).then(n.bind(function(){this.pump(e)},this)).fail(function(t){throw t})}}),define("pump",["require","exports","module","subject","lodash","pipe","./__pump/pipe","./__pump/streams/pump","./__pump/streams/drain","./__pump/streams/inject"],function(t,e,n){var r=t("subject"),i=t("lodash"),o=t("pipe"),s=["srcGet","srcSet","destGet","destSet"],u=n.exports=r({initialize:function(t,e){this.source=t,this._buildPipe=o.extend(i.pick(this,s)),this.pipes={},i.each(e,function(t,e){this.pipe(e,t)},this)},from:function(t){return this.source=t,i.each(this.pipes,function(e){e.from(t)}),this},get:function(t,e){return t[e]},set:function(t,e,n){return t[e]=n,this}});u.assignProto(t("./__pump/pipe")).assignProto(t("./__pump/streams/pump")).assignProto(t("./__pump/streams/drain")).assignProto(t("./__pump/streams/inject"))}),define("__jquery-meta-data/helpers",["require","exports","module","jquery","lodash"],function(t,e){t("jquery"),t("lodash"),e.buildPrefixRegExp=function(t){return new RegExp("^"+t+"([A-Z$_].*$)")},e.lowercaseFirst=function(t){return t.charAt(0).toLowerCase()+t.slice(1)},e.uppercaseFirst=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},e.fullKey=function(t,n){return t?t+e.uppercaseFirst(n):n}}),define("__jquery-meta-data/read",["require","exports","module","lodash","./helpers"],function(t,e){function n(t){return t}var r=t("lodash"),i=t("./helpers");e.all=function(t,e){var o=t.data(),s=e.parse||n;if(e.prefix){var u=i.buildPrefixRegExp(e.prefix);return r.transform(o,function(n,r,o){var a=o.match(u);if(a){var p=i.lowercaseFirst(a[1]);r=s(r,p,o),e.replace&&t.data(o,r),n[p]=r}})}return r.mapValues(o,function(t,e){return s(t,e,e)})},e.single=function(t,e,n){var r=i.fullKey(e.prefix,n),o=t.data(r);return e.parse&&(o=e.parse(o,n,r),e.replace&&t.data(r,o)),o}}),define("__jquery-meta-data/set",["require","exports","module","lodash","./helpers"],function(t,e){var n=t("lodash"),r=t("./helpers");e.single=function(t,e,n,i){var o=r.fullKey(e.prefix,n);i=e.stringify?e.stringify(i,n,o):i,t.data(o,i)},e.multiple=function(t,r,i){n.each(i,function(n,i){e.single(t,r,i,n)})}}),define("jquery-meta-data",["require","exports","module","jquery","lodash","./__jquery-meta-data/read","./__jquery-meta-data/set"],function(t){var e=t("jquery"),n=t("lodash"),r=t("./__jquery-meta-data/read"),i=t("./__jquery-meta-data/set"),o={};e.metaData=function(){n.isObject(arguments[0])?n.assign(o,arguments[0]):o[arguments[0]]=arguments[1]},e.prototype.metaData=function(t){return t=n.isString(t)?o[t]:t,1===arguments.length?r.all(this,t):2!==arguments.length?(i.single(this,t,arguments[1],arguments[2]),this):n.isString(arguments[1])?r.single(this,t,arguments[1]):n.isObject(arguments[1])?(i.multiple(this,t,arguments[1]),this):void 0}}),define("__jquery-pump/parse-method-string",["require","exports","module"],function(t,e,n){var r=/\s*:\s*/g,i=/(?:(.+?)\|)?(.+?)$/;n.exports=function(t){var e=t.match(i),n=e[2].split(r),o=n.shift();return{selector:e[1],method:o,args:n}}}),define("__jquery-pump/getter-setter",["require","exports","module","jquery","./parse-method-string"],function(t,e){var n=(t("jquery"),t("./parse-method-string"));e.destGet=function(t,e){var r=n(e);return t[r.method].apply(t,r.args)},e.destSet=function(t,e,r){var i=n(e),o=i.selector,s=i.args;return s.push(r),t=o?t.find(o):t,t[i.method].apply(t,s)}}),define("jquery-pump",["require","exports","module","pump","jquery","jquery-meta-data","./__jquery-pump/getter-setter"],function(t,e,n){var r=t("pump"),i=t("jquery"),o=(t("jquery-meta-data"),n.exports=r.extend({initialize:function(t,e){e=e||{};var n=e.destination;_.defaults(e,this.metaDataOptions),_.defaults(e,{prefix:this.prefix}),r.prototype.initialize.call(this,t),_.each(n,function(t){var n=i(t),r=n.metaData(e),o=this.pipe(r);o.to(n)},this)},prefix:"pipe",metaDataOptions:{parse:function(t){return t.split(/\s*,\s*/g)}}}));o.assignProto(t("./__jquery-pump/getter-setter")),i.prototype.pump=function(t,e){return e=e||{},e.destination=this,o(t,e)}}),define("__bb-model-view/model-pump",["require","exports","module","jquery-pump"],function(t,e,n){{var r=t("jquery-pump");n.exports=r.extend({srcGet:function(t,e){return t.get(e)},srcSet:function(t,e,n){return t.set(e,n)}})}}),define("bb-model-view",["require","exports","module","lodash","lowercase-backbone","jquery-pipe","./__bb-model-view/model-pump"],function(t,e,n){{var r=t("lodash"),i=t("lowercase-backbone"),o=(t("jquery-pipe"),t("./__bb-model-view/model-pump")),s=["map","parsers","stringifiers"];n.exports=i.view.extend({bbmvUIDAttribute:"bbmvUID",initialize:function(){i.view.prototype.initialize.apply(this,arguments),this.initializeModelView.apply(this,arguments)},initializeModelView:function(t){if(!this.model)throw new Error("No model set for model view.");if(!this.$el)throw new Error("No el set on model view.");t=t||{},r.defaults(t,r.pick(this,s)),r.assign(this,t);{var e=this.$el.add(this.$el.find(this.bindingSelector));o(e)}},prefix:"bind",bindingSelector:":data-prefix(bind)",stringifiers:{},parsers:{}})}});